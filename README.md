# FK-Onmyoji
**阴阳师抗检测多功能护肝辅助脚本**

 - 游戏多开，多种模式并发
 - 鼠标键盘模拟输入，指针变速移动，非固定点点击，随机间隔连点
 - 掉线、失败、占用警报提示
 - 抗失效随机点击复位
 - 自动接受悬赏封印邀请
 - QQ消息反馈

 
----------


# 开始

## 方案1：直接下载可执行程序 ##
 [Beta 1.0.0下载地址][2]

## 方案2：部署运行环境 ##

 1. 安装Python3.7（>=3.7）。

 2. 安装拓展库：
    PyAutoGUI
    OpenCV-Python
    PyWin32

 3. 调整阴阳师窗口分辨率至固定合适大小（可选）：
    -打开阴阳师安装目录下的neox.xml文件，修改WindowClientHeight（窗口高度），WindowClientWidth（窗口宽度）。推荐宽度为683，高度为384。

 4. 根据screenshots文件夹下的截图样例截取图片（推荐宽高下可跳过）。

 5. 运行screenshots文件夹下的convert.py（可选，截取新截图后推荐，可防止libpng相关警告，需要安装ImageMagick，下附下载地址）
    -打开convert.py文件修改imageMagickPath变量的值为ImageMagick安装路径。
 [ImageMagick-6.2.7-Q16下载地址][1]

 
----------


## 使用 ##
 1. 手动完成一局已选模式以锁定阵容（结界突破、章节探索除外）。
 2. 以管理员身份运行（必须，以防止鼠标键盘模拟输入失效）。
 3. 根据提示输入相关信息（因为设置的窗口宽高不包括边框宽高，故需将高度适当增大，比如30）
	-样例：
		[2019-10-19 00:54:23]:账户数:2
		[2019-10-19 00:54:23]:游戏类型(1.御魂/觉醒 2.章节探索 3.业原火 4.结界突破):1
		[2019-10-19 00:54:23]:局数:250
		[2019-10-19 00:54:23]:窗口起始位置X:0
		[2019-10-19 00:54:23]:窗口起始位置Y:0
		[2019-10-19 00:54:23]:窗口宽度:683
		[2019-10-19 00:54:23]:窗口高度:410
		[2019-10-19 00:54:23]:是否为房主(Y/N):n
		[2019-10-19 00:54:23]:QQ反馈者名称:lzycc234
		[2019-10-19 00:54:23]:游戏类型(1.御魂/觉醒 2.章节探索 3.业原火 4.结界突破):1
		[2019-10-19 00:54:23]:局数:250
		[2019-10-19 00:54:23]:窗口起始位置X:683
		[2019-10-19 00:54:23]:窗口起始位置Y:0
		[2019-10-19 00:54:23]:窗口宽度:683
		[2019-10-19 00:54:23]:窗口高度:410
		[2019-10-19 00:54:23]:是否为房主(Y/N):y
		[2019-10-19 00:54:23]:QQ反馈者名称:Jason
 4. 挂机（按P暂停/继续）。

## 相关问题 & 注意事项 ##
 1. 注意：以下情况蜂鸣器会发出警报声（加*的建议进行人工操作）：
    -已选模式全部结束
    -检测到悬赏封印邀请
    *-失败（警报声结束后关闭所有游戏，结界突破除外）
    *-失去连接
    *-脚本可能失效，超过5分钟未进行任何操作
    *-检测到账户在其他设备登录（警报声结束后关闭所有游戏）
 2. 问题：窗口起始位置是什么？
    -窗口边框左上角相对于屏幕左上角的位置
 3. 问题："QQ反馈者"必填吗？填什么？
    -可选，请填入聊天窗口的标题，不需要请填写任意字符。聊天窗口位置没有要求，不能最小化。
 4. 问题：怎样去除"警报声结束后关闭所有游戏"的功能？
    -删除代码`os.system("taskkill /IM onmyoji.exe /F")`
## 关于 ##
学了一天Python来练手的。


  [1]: https://t00y.com/file/15016760-403129810
  [2]: https://t00y.com/file/15016760-403156759